// TODO: make it atomic (thread-safe)